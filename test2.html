<html>
<meta name="viewport" content = "width = device-width, initial-scale=1, maximum-scale=1" />
<script src="scripts/jquery.js"></script>
<style type="text/css">
#blah, #foo {
    border: 0px solid black;
    background-color: red;
    position: static;
    width: 204px;
    height: 153px;
}
#blah {
    -webkit-transition: all .3s ease-in-out; 
    -webkit-transform-origin: 0% 0%; 
    position: fixed;
    top:0;
    left:0;
    display: none;
    border: 0px solid red;
}
/*
#blah:hover {
    -webkit-transform: scale(5,5); 
}
*/

</style>
<body>

<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<p>
<img id="foo" src="content/barn.thumb.jpg"/>
<img id="blah" src="content/barn.jpg"/>
</p>
<h3>some text after the zooming</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<h3>zooming test</h3>
<script>

var zoomed = false;
var blah = document.getElementById("blah");

var foo = document.getElementById("foo");
foo.addEventListener("mousedown", function(e) {
    var pos = $("#foo").offset();
    var scrolltop = $("body").scrollTop();
    blah.style.top = pos.top-scrolltop;
    blah.style.left = pos.left;
    blah.style.display = "block";
    
    var sx = window.innerWidth/blah.offsetWidth;
    var sy = window.innerHeight/blah.offsetHeight;
    var percentage = ((scrolltop+foo.offsetHeight/2)/window.innerHeight);
    var s = Math.min(sx,sy);
    
    blah.style.webkitTransform =
        'translate('+(-pos.left)+'px,'+(-pos.top)+'px)'+
        'scale('+s+')';
    blah.style.webkitTransformOrigin = "0% "+(percentage*-100)+"%";
    zoomed = true;
},false);

blah.addEventListener( "mousedown", function(e) {
    blah.style.webkitTransform = 'scale(1)';
    zoomed = false;
});

blah.addEventListener( 'webkitTransitionEnd', function( event ) {
    if(!zoomed) {
        blah.style.display = "none";
    }
}, false );


</script>
</body>
</html>
